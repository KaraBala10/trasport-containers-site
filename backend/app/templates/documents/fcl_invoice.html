<!DOCTYPE html>
<html lang="{{ language }}" dir="{% if language == 'ar' %}rtl{% else %}ltr{% endif %}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice / فاتورة - {{ invoice_number }}</title>
    <style>
        @page {
            size: A4;
            margin: 1cm;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: {% if language == 'ar' %}'Cairo', 'Arial', sans-serif{% else %}'Inter', 'Arial', sans-serif{% endif %};
            font-size: 12px;
            line-height: 1.5;
            color: #1a365d;
            direction: {% if language == 'ar' %}rtl{% else %}ltr{% endif %};
            background: #ffffff;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 12px;
            border-bottom: 3px solid #1a365d;
            background: linear-gradient(135deg, #f7fafc 0%, #ffffff 100%);
            border-radius: 6px;
            page-break-inside: avoid;
        }
        
        .logo-container {
            margin-bottom: 8px;
        }
        
        .logo-container img {
            max-width: 140px;
            max-height: 70px;
            object-fit: contain;
        }
        
        .company-info {
            flex: 1;
        }
        
        .company-name {
            font-size: 24px;
            font-weight: 900;
            color: #1a365d;
            margin-bottom: 4px;
            letter-spacing: -0.5px;
        }
        
        .company-tagline {
            font-size: 14px;
            color: #fbbf24;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .company-details {
            font-size: 11px;
            color: #2d3748;
            line-height: 1.6;
        }
        
        .invoice-info {
            text-align: {% if language == 'ar' %}left{% else %}right{% endif %};
            min-width: 220px;
        }
        
        .invoice-title {
            font-size: 32px;
            font-weight: 900;
            color: #1a365d;
            margin-bottom: 12px;
            text-transform: uppercase;
        }
        
        .invoice-details {
            font-size: 11px;
            color: #2d3748;
            background: #f7fafc;
            padding: 10px;
            border-radius: 4px;
            border: 2px solid #e2e8f0;
        }
        
        .invoice-details p {
            margin: 5px 0;
        }
        
        .invoice-label {
            font-weight: 700;
            color: #1a365d;
        }
        
        .qr-code-container {
            margin-top: 10px;
            text-align: center;
            padding: 8px;
            background: #ffffff;
            border-radius: 4px;
            border: 2px solid #e2e8f0;
        }
        
        .qr-code-container img {
            width: 90px;
            height: 90px;
            border: 2px solid #1a365d;
            padding: 6px;
            background: white;
            border-radius: 4px;
        }
        
        .qr-code-label {
            font-size: 9px;
            color: #1a365d;
            margin-top: 6px;
            font-weight: 600;
        }
        
        .section {
            margin-bottom: 18px;
            page-break-inside: avoid;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: 800;
            color: #1a365d;
            margin-bottom: 12px;
            padding-bottom: 6px;
            border-bottom: 3px solid #fbbf24;
            text-transform: uppercase;
        }
        
        .address-box {
            background: linear-gradient(135deg, #f7fafc 0%, #ffffff 100%);
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid #1a365d;
            margin-bottom: 12px;
        }
        
        .address-label {
            font-weight: 800;
            color: #1a365d;
            margin-bottom: 8px;
            font-size: 13px;
            text-transform: uppercase;
        }
        
        .address-content {
            font-size: 11px;
            color: #2d3748;
            line-height: 1.6;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .info-item {
            background: #f7fafc;
            padding: 10px;
            border-radius: 4px;
            border-left: 3px solid #1a365d;
        }
        
        .info-label {
            font-weight: 700;
            color: #1a365d;
            font-size: 11px;
            margin-bottom: 4px;
        }
        
        .info-value {
            font-size: 12px;
            color: #2d3748;
            font-weight: 600;
        }
        
        .summary-box {
            background: linear-gradient(135deg, #f7fafc 0%, #ffffff 100%);
            padding: 15px;
            border-radius: 6px;
            border: 2px solid #1a365d;
            margin-top: 15px;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .summary-row:last-child {
            border-bottom: none;
        }
        
        .summary-label {
            font-weight: 600;
            color: #2d3748;
            font-size: 11px;
        }
        
        .summary-value {
            font-weight: 700;
            color: #1a365d;
            font-size: 12px;
        }
        
        .total-row {
            font-size: 16px;
            font-weight: 900;
            color: #1a365d;
            padding-top: 10px;
            margin-top: 10px;
            border-top: 3px solid #1a365d;
        }
        
        .total-row .summary-value {
            font-size: 18px;
        }
        
        .footer {
            margin-top: 20px;
            padding-top: 12px;
            border-top: 2px solid #e2e8f0;
            text-align: center;
            font-size: 10px;
            color: #4a5568;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="company-info">
            {% if company.logo_base64 %}
            <div class="logo-container">
                <img src="data:image/png;base64,{{ company.logo_base64 }}" alt="Medo-Freight EU Logo">
            </div>
            {% endif %}
            <div class="company-name">Medo-Freight EU</div>
            <div class="company-tagline">Ship · Route · Deliver</div>
            <div class="company-details">
                Titanlaan 1, 4624 AX Bergen op Zoom, The Netherlands<br>
                Kvk nr: 75251663<br>
                TAX nr: NL002518102B41<br>
                EORI number: NL1320963189<br>
                Phone: +31 6 39 788 989<br>
                Email: contact@medo-freight.eu<br>
                Website: www.medo-freight.eu
            </div>
        </div>
        <div class="invoice-info">
            <div class="invoice-title">
                {% if language == 'ar' %}فاتورة{% else %}INVOICE{% endif %}
            </div>
            <div class="invoice-details">
                <p>
                    <span class="invoice-label">{% if language == 'ar' %}رقم الفاتورة:{% else %}Invoice #:{% endif %}</span>
                    {{ invoice_number }}
                </p>
                <p>
                    <span class="invoice-label">{% if language == 'ar' %}رقم العرض:{% else %}Quote #:{% endif %}</span>
                    {{ quote.quote_number|default:quote.id }}
                </p>
                <p>
                    <span class="invoice-label">{% if language == 'ar' %}التاريخ:{% else %}Date:{% endif %}</span>
                    {{ invoice_date|date:"Y-m-d" }}
                </p>
            </div>
            {% if qr_code_base64 %}
            <div class="qr-code-container">
                <img src="data:image/png;base64,{{ qr_code_base64 }}" alt="Tracking QR Code">
                <div class="qr-code-label">
                    {% if language == 'ar' %}تتبع الشحنة{% else %}Track Shipment{% endif %}
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- FROM / TO -->
    <div class="section">
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
            <div class="address-box">
                <div class="address-label">{% if language == 'ar' %}من:{% else %}FROM:{% endif %}</div>
                <div class="address-content">
                    <strong>{{ company.name }}</strong><br>
                    {{ company.address }}<br>
                    {{ company.phone }}<br>
                    {{ company.email }}
                </div>
            </div>
            <div class="address-box">
                <div class="address-label">{% if language == 'ar' %}إلى:{% else %}TO:{% endif %}</div>
                <div class="address-content">
                    <strong>{{ quote.full_name }}</strong><br>
                    {% if quote.company_name %}{{ quote.company_name }}<br>{% endif %}
                    {{ quote.country }}<br>
                    {{ quote.phone }}<br>
                    {{ quote.email }}
                </div>
            </div>
        </div>
    </div>

    <!-- Quote Details -->
    <div class="section">
        <div class="section-title">{% if language == 'ar' %}تفاصيل العرض{% else %}QUOTE DETAILS{% endif %}</div>
        <div class="info-grid">
            <div class="info-item">
                <div class="info-label">{% if language == 'ar' %}نوع الحاوية:{% else %}Container Type:{% endif %}</div>
                <div class="info-value">{{ quote.get_container_type_display }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">{% if language == 'ar' %}عدد الحاويات:{% else %}Number of Containers:{% endif %}</div>
                <div class="info-value">{{ quote.number_of_containers }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">{% if language == 'ar' %}ميناء التحميل:{% else %}Port of Loading:{% endif %}</div>
                <div class="info-value">{{ quote.port_of_loading }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">{% if language == 'ar' %}ميناء التفريغ:{% else %}Port of Discharge:{% endif %}</div>
                <div class="info-value">{{ quote.port_of_discharge }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">{% if language == 'ar' %}البلد الأصلي:{% else %}Origin Country:{% endif %}</div>
                <div class="info-value">{{ quote.origin_country }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">{% if language == 'ar' %}البلد الوجهة:{% else %}Destination Country:{% endif %}</div>
                <div class="info-value">{{ quote.destination_country }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">{% if language == 'ar' %}الوزن الإجمالي:{% else %}Total Weight:{% endif %}</div>
                <div class="info-value">{{ quote.total_weight }} kg</div>
            </div>
            <div class="info-item">
                <div class="info-label">{% if language == 'ar' %}الحجم الإجمالي:{% else %}Total Volume:{% endif %}</div>
                <div class="info-value">{{ quote.total_volume }} CBM</div>
            </div>
        </div>
    </div>

    <!-- Pricing Summary -->
    <div class="section">
        <div class="section-title">{% if language == 'ar' %}ملخص الأسعار{% else %}PRICING SUMMARY{% endif %}</div>
        <div class="summary-box">
            {% if quote.price_per_container %}
            <div class="summary-row">
                <span class="summary-label">{% if language == 'ar' %}السعر لكل حاوية:{% else %}Price Per Container:{% endif %}</span>
                <span class="summary-value">€{{ quote.price_per_container }}</span>
            </div>
            {% endif %}
            <div class="summary-row total-row">
                <span>{% if language == 'ar' %}الإجمالي:{% else %}TOTAL:{% endif %}</span>
                <span>€{{ quote.total_price }}</span>
            </div>
            {% if quote.amount_paid %}
            <div class="summary-row">
                <span class="summary-label">{% if language == 'ar' %}المبلغ المدفوع:{% else %}Amount Paid:{% endif %}</span>
                <span class="summary-value">€{{ quote.amount_paid }}</span>
            </div>
            {% endif %}
            {% if remaining_amount > 0 %}
            <div class="summary-row">
                <span class="summary-label">{% if language == 'ar' %}المبلغ المتبقي:{% else %}Remaining:{% endif %}</span>
                <span class="summary-value">€{{ remaining_amount }}</span>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p><strong>Medo-Freight EU</strong> | {{ company.website }} | {{ company.email }}</p>
        <p>{% if language == 'ar' %}هذه فاتورة رسمية.{% else %}This is an official invoice.{% endif %}</p>
    </div>
</body>
</html>

